{"version":3,"file":"index.js","sourceRoot":"","sources":["../../../src/event-utils/index.ts"],"names":[],"mappings":"AAAA,MAAM,OAAO,GAAG,yCAAyC,CAAC;AAE1D,SAAS,aAAa,CAAC,MAAc,EAAE,MAAc;IACnD,MAAM,KAAK,GAAG,MAAM,CAAC,QAAQ,CAAC,EAAE,EAAE,GAAG,CAAC,CAAC;IACvC,MAAM,UAAU,GAAG,KAAK,CAAC,MAAM,GAAG,MAAM,CAAC;IACzC,IAAI,UAAU,IAAI,CAAC,EAAE,CAAC;QACpB,OAAO,CAAC,EAAE,EAAE,KAAK,CAAC,CAAC,CAAC,sEAAsE;IAC5F,CAAC;IACD,MAAM,SAAS,GAAG,KAAK,CAAC,KAAK,CAAC,CAAC,EAAE,UAAU,CAAC,CAAC;IAC7C,MAAM,cAAc,GAAG,KAAK,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC;IAC/C,OAAO,CAAC,SAAS,EAAE,cAAc,CAAC,CAAC;AACrC,CAAC;AAED,MAAM,OAAO,kBAAkB;IAC7B,YAA4B,GAAQ;QAAR,QAAG,GAAH,GAAG,CAAK;IAAG,CAAC;IACxC,MAAM;;QACJ,MAAM,GAAG,GAAU,EAAE,CAAC;QACtB,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,MAAA,MAAA,IAAI,CAAC,GAAG,0CAAE,IAAI,0CAAE,KAAK,CAAC;YAAE,OAAO,GAAG,CAAC;QAEtD,KAAK,MAAM,OAAO,IAAI,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,KAAK,EAAE,CAAC;YAC1C,MAAM,IAAI,GAAG,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC;YAC1C,KAAK,MAAM,SAAS,IAAI,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,OAAO,EAAE,CAAC;gBAC9C,MAAM,MAAM,GAAG,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC;gBAChD,MAAM,KAAK,GAAG,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC,SAAS,CAAC,CAAC;gBACvD,MAAM,UAAU,GAAG,aAAa,CAAC,KAAK,CAAC,QAAQ,EAAE,EAAE,EAAE,CAAC,CAAC;gBACvD,IAAI,KAAK,CAAC,QAAQ,EAAE,KAAK,OAAO,EAAE,CAAC;oBACjC,GAAG,CAAC,IAAI,CAAC;wBACP,IAAI,EAAE,IAAI,CAAC,QAAQ,EAAE;wBACrB,MAAM,EAAE,MAAM,CAAC,QAAQ,EAAE;wBACzB,KAAK,EAAE,IAAI;qBACZ,CAAC,CAAC;gBACL,CAAC;qBAAM,CAAC;oBACN,GAAG,CAAC,IAAI,CAAC;wBACP,IAAI,EAAE,IAAI,CAAC,QAAQ,EAAE;wBACrB,MAAM,EAAE,MAAM,CAAC,QAAQ,EAAE;wBACzB,KAAK,EAAE,GAAG,UAAU,CAAC,CAAC,CAAC,IAAI,UAAU,CAAC,CAAC,CAAC,EAAE;qBAC3C,CAAC,CAAC;gBACL,CAAC;YACH,CAAC;QACH,CAAC;QACD,OAAO,GAAG,CAAC;IACb,CAAC;CACF","sourcesContent":["const I128MAX = \"170141183460469231731687303715884105727\";\n\nfunction splitFromTail(input_: string, places: number): [string, string] {\n  const input = input_.padStart(18, \"0\");\n  const splitIndex = input.length - places;\n  if (splitIndex <= 0) {\n    return [\"\", input]; // if the string is shorter than N characters, the first part is empty\n  }\n  const firstPart = input.slice(0, splitIndex);\n  const lastCharacters = input.slice(splitIndex);\n  return [firstPart, lastCharacters];\n}\n\nexport class PullFeedValueEvent {\n  constructor(public readonly raw: any) {}\n  toRows(): Array<{ feed: string; oracle: string; value: string | null }> {\n    const out: any[] = [];\n    if (!Array.isArray(this.raw?.data?.feeds)) return out;\n\n    for (const feedIdx in this.raw.data.feeds) {\n      const feed = this.raw.data.feeds[feedIdx];\n      for (const oracleIdx in this.raw.data.oracles) {\n        const oracle = this.raw.data.oracles[oracleIdx];\n        const value = this.raw.data.values[feedIdx][oracleIdx];\n        const valueParts = splitFromTail(value.toString(), 18);\n        if (value.toString() === I128MAX) {\n          out.push({\n            feed: feed.toString(),\n            oracle: oracle.toString(),\n            value: null,\n          });\n        } else {\n          out.push({\n            feed: feed.toString(),\n            oracle: oracle.toString(),\n            value: `${valueParts[0]}.${valueParts[1]}`,\n          });\n        }\n      }\n    }\n    return out;\n  }\n}\n"]}